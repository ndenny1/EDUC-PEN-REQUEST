pipeline{
    agent any

    tools{
        nodejs "nodejs"
    }

    stages{
        stage('e2e tests'){
            steps{
                script{
                    timeout(10){
                        dir('frontend'){
                            checkout scm
                            echo 'Running e2e tests'

                            sh 'npm install -g testcafe'
                            sh 'testcafe --list-browsers'
                            sh 'testcafe \'path:`/var/lib/jenkins/tools/jenkins.plugins.nodejs.tools.NodeJSInstallation/nodejs/lib/node_modules/chromium/lib/chromium/chrome-win/chrome.exe`\' ./tests/e2e/test.js'
                        }
                    }
                }
            }
        }
    }
}