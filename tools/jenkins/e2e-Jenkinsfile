pipeline{
    agent any

    tools{
        nodejs "nodejs"
    }

    stages{
        stage('e2e tests'){
            steps{
                script{
                    timeout(10){
                        dir('frontend'){
                            checkout scm
                            echo 'Running e2e tests'
                            sh 'npm install'
                            sh 'npm install -g chromium'
                            sh 'npm install -g testcafe'
                            sh 'testcafe --list-browsers'
                            sh 'testcafe \'path:`./node_modules/.bin/chromedriver`\'./tests/e2e/test.js'
                        }
                    }
                }
            }
        }
    }
}