pipeline{
    agent any

    tools{
        nodejs "nodejs"
    }

    stages{
        stage('e2e tests'){
            steps{
                script{
                    timeout(10){
                        dir('frontend'){
                            checkout scm
                            echo 'Running e2e tests'
                            sh 'apt-get install libxcursor-dev:i386'
                            sh 'testcafe \"chrome:`/var/lib/jenkins/tools/jenkins.plugins.nodejs.tools.NodeJSInstallation/nodejs/lib/node_modules/chromium/lib/chromium/chrome-linux/chrome`\" ./tests/e2e/test.js'
                        }
                    }
                }
            }
        }
    }
}